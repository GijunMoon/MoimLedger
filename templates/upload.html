<!--
### MoimLedger
## Author: Gijun Moon
## Date: 26-02-23
-->

<!DOCTYPE html>
<html class="light" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Upload and Add Members - Moim Ledger</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght@100..700,0..1&display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#9ed7ff",
                        "background-light": "#f7f8f0",
                        "background-dark": "#0f1b23"
                    },
                    fontFamily: {
                        "display": ["Manrope"]
                    }
                }
            }
        }
    </script>
<style>
        body {
            font-family: "Manrope", sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 antialiased font-display">
<div class="relative flex min-h-screen w-full flex-col max-w-[430px] mx-auto bg-background-light dark:bg-background-dark shadow-2xl overflow-x-hidden">
<div class="sticky top-0 z-10 flex items-center bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-md p-4 pb-2 justify-between border-b border-slate-200 dark:border-slate-800">
<a class="text-slate-900 dark:text-slate-100 flex size-10 shrink-0 items-center justify-center rounded-full hover:bg-primary/20" href="/">
<span class="material-symbols-outlined">arrow_back_ios_new</span>
</a>
<h2 class="text-slate-900 dark:text-slate-100 text-lg font-bold leading-tight tracking-tight flex-1 text-center pr-10">Upload Expenses</h2>
</div>

<main class="flex-1 overflow-y-auto px-6 pb-24">
{% if error %}
<div class="mt-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">{{ error }}</div>
{% endif %}

<div class="mt-6 rounded-xl bg-white dark:bg-slate-900 p-5 shadow-sm border border-slate-100 dark:border-slate-800">
<p class="text-sm text-slate-500 dark:text-slate-400">Session ID</p>
<p class="mt-1 break-all text-xs font-semibold">{{ result.session_id }}</p>
</div>

<div class="mt-4 rounded-xl bg-white dark:bg-slate-900 p-5 shadow-sm border border-slate-100 dark:border-slate-800">
<div class="mb-3">
<p class="text-lg font-bold">Receipt Upload (OCR)</p>
<p class="text-sm text-slate-500 dark:text-slate-400">Upload image and select payer.</p>
</div>
<form action="/ocr/{{ result.session_id }}" enctype="multipart/form-data" method="post" class="space-y-3">
<input class="w-full rounded-lg" name="file" required type="file"/>
<select class="w-full rounded-lg" name="payer" required>
{% for name in result.member_list %}
<option value="{{ name }}">{{ name }}</option>
{% endfor %}
</select>
<button class="w-full rounded-lg bg-primary py-3 px-4 text-slate-900 font-bold" type="submit">Scan Now</button>
</form>
</div>

<div class="mt-4 rounded-xl bg-white dark:bg-slate-900 p-5 shadow-sm border border-slate-100 dark:border-slate-800">
<div class="mb-3">
<p class="text-lg font-bold">CSV Upload</p>
<p class="text-sm text-slate-500 dark:text-slate-400">Columns required: amount, payer.</p>
</div>
<form action="/upload-csv/{{ result.session_id }}" enctype="multipart/form-data" method="post" class="space-y-3">
<input class="w-full rounded-lg" name="file" required type="file"/>
<button class="w-full rounded-lg bg-slate-100 dark:bg-slate-800 py-3 px-4 font-bold" type="submit">Browse Files</button>
</form>
</div>

<div class="mt-6">
<div class="flex items-center justify-between">
<h3 class="text-lg font-bold">Session Members</h3>
<span class="bg-primary/30 text-slate-900 dark:text-slate-100 text-xs font-bold px-2 py-1 rounded-full">{{ result.member_list|length }} Added</span>
</div>
<div class="mt-3 space-y-2">
{% for member in result.member_list %}
<div class="flex items-center justify-between p-3 rounded-xl bg-white dark:bg-slate-900 border border-slate-50 dark:border-slate-800 shadow-sm">
<span class="text-sm font-semibold">{{ member }}</span>
<span class="material-symbols-outlined text-slate-300">check_circle</span>
</div>
{% endfor %}
</div>
</div>
</main>

<div class="fixed bottom-0 w-full max-w-[430px] bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 p-4 pb-8">
<a class="w-full flex items-center justify-center gap-2 rounded-xl bg-primary py-4 px-4 text-slate-900 font-extrabold text-base shadow-lg" href="/result/{{ result.session_id }}">
Process Ledger
<span class="material-symbols-outlined">arrow_forward</span>
</a>
</div>
</div>
</body>
</html>
